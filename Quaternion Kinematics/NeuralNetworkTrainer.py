import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np

import DQClass
import RandomizerRedacted

# Generate some dummy data (Replace with actual Stewart platform data)
num_samples = 50000
input_dim = 6  # Leg lengths
output_dim = 8  # Pose dual quaternions

Y_train = np.array([RandomizerRedacted.MakeRandomPose().ToFullVec() for _ in range(num_samples)])  # Outputs
X_train = np.array([RandomizerRedacted.LegLengthsRedacted(DQClass.ToDualQuaternion(item)) for item in Y_train]) # Inputs

# Define the neural network model
model = keras.Sequential([
    layers.Dense(64, activation="relu", input_shape=(input_dim,)),
    layers.Dense(64, activation="relu"),
    layers.Dense(64, activation="relu"),
    layers.Dense(64, activation="relu"),
    layers.Dense(output_dim)  # No activation for regression problems
])

# Compile the model
model.compile(optimizer="adam", loss="mse", metrics=["mae"])

# Train the model
model.fit(X_train, Y_train, epochs=100, batch_size=10, validation_split=0.2)

# Test the model on new data
Y_test = np.array([RandomizerRedacted.MakeRandomPose().ToFullVec() for _ in range(10)])
X_test = np.array([RandomizerRedacted.LegLengthsRedacted(DQClass.ToDualQuaternion(item)) for item in Y_test])
predictions = model.predict(X_test)
model.save(r"C:\Users\cch30\PycharmProjects\QuaternionKinematics")




#20000 samples + 2 (or three?) Hidden layers
# Poses= [[9.99999960e-01,  1.49567266e-04, -1.84044561e-04,  1.51647837e-04,
#   -8.23290331e-03,  1.59025938e+02,  1.19482240e+02,  4.24528619e+01],
#  [9.94653897e-01,  3.00992152e-02, -9.22350035e-02, -3.53605175e-02,
#    2.77564240e+00,  1.53236755e+02,  3.76815992e+01,  1.10223137e+02],
#  [ 9.81313223e-01,  5.06272552e-02,  1.25540386e-01, -1.36751057e-01,
#   -9.14599456e+00, -1.17353259e+01,  1.04514902e+02,  2.59714879e+01],
#  [ 9.72130130e-01,  2.31577269e-02,  2.14989453e-01,  9.05884387e-02,
#   -5.22736637e+01,  3.53279784e+01,  2.06742395e+02,  6.12799330e+01],
#  [ 9.99977802e-01, -6.01325702e-03, -9.98797833e-04, -2.69048106e-03,
#    1.01022028e+00,  1.48452985e+02,  2.87004663e+01,  3.30223238e+01],
#  [ 9.98852825e-01, -2.28850654e-02, -2.59177481e-02,  3.31297052e-02,
#    6.17339730e-01,  2.37989491e+02,  8.33663148e+01,  2.11002201e+02],
#  [ 9.85514439e-01, -2.29957149e-02, -9.82149133e-02, -1.36331646e-01,
#    3.63288958e+01,  1.34944075e+02,  1.55646655e+02,  1.27723047e+02],
#  [ 9.86762771e-01, -9.78652537e-02, -8.76461017e-02,  9.50777966e-02,
#    5.77995830e+00,  1.98209885e+02, -2.82715509e+01,  1.17972042e+02],
#  [ 9.69816108e-01, -1.24810856e-01, -3.08625830e-02, -2.07187036e-01,
#    4.70644004e+01,  1.22946963e+02,  2.55127524e+01,  1.42438007e+02],
#  [ 9.91534557e-01,  8.28935680e-02,  3.07934199e-02,  9.50770417e-02,
#   -2.12936541e+01,  1.21784631e+02,  1.24581632e+02,  7.55380749e+01]]
# Predictions= [[ 9.94137526e-01 -1.92862190e-02,  1.26846582e-02,  2.94411778e-02,
#    3.39990902e+00,  1.62284683e+02,  1.21025795e+02,  4.69910507e+01],
#  [9.93609846e-01, -5.35254180e-03, -4.82773036e-02,  1.71707273e-02,
#    4.09072208e+00,  1.52366486e+02,  4.44930496e+01,  1.06143684e+02],
#  [ 9.70547795e-01,  7.43570365e-03,  1.13633275e-01, -1.45515859e-01,
#   -9.39041615e+00, -5.89202785e+00,  1.07222481e+02,  3.95716629e+01],
#  [ 9.77124035e-01,  2.25427561e-02,  2.58666784e-01,  1.78430080e-02,
#   -4.79480705e+01,  5.17829323e+01,  2.23346786e+02,  7.13304367e+01],
#  [ 9.97872710e-01, -3.31335925e-02,  2.14767605e-02,  4.54001427e-02,
#   -1.15633130e+00,  1.48422745e+02,  3.31437912e+01,  3.09460735e+01],
#  [ 9.86091256e-01, -5.86851314e-02,  7.63851404e-03,  8.48200321e-02,
#    6.66922283e+00,  2.38306870e+02,  9.07509766e+01,  2.11396332e+02],
#  [ 9.78087723e-01, -4.32342365e-02, -7.54147321e-02, -4.80898023e-02,
#    3.14552841e+01,  1.31557968e+02,  1.63212280e+02,  1.12498337e+02],
#  [ 9.91684437e-01, -1.39705658e-01, -3.66436690e-02,  1.38711423e-01,
#    4.47460938e+00,  1.92267319e+02, -2.00250053e+01,  1.04523735e+02],
#  [ 9.84411538e-01, -1.42452508e-01, -1.45814717e-02, -7.66876340e-02,
#    2.73208427e+01,  1.28431458e+02,  3.55668831e+01,  1.03829102e+02],
#  [ 9.96769011e-01,  4.15401831e-02,  7.16749132e-02,  1.05313927e-01,
#   -2.45336952e+01,  1.25369141e+02,  1.23375725e+02,  8.17578049e+01]]

#30000 samples + 1 Hidden layer
# Poses=  [[ 9.80046938e-01,  6.52924137e-02, -7.86062026e-02, -1.70487436e-01,
#    9.52040115e+00,  2.20176528e+02,  1.05298982e+02,  9.05001815e+01],
#  [ 9.94505281e-01, -4.85096002e-03, -8.50502508e-02,  6.08454528e-02,
#    7.51471735e+00,  1.65595566e+02,  1.42134133e+02,  8.90520952e+01],
#  [ 9.98603025e-01,  3.26626507e-02, -4.14095835e-02,  3.22415754e-03,
#    4.22874975e+00,  1.31242515e+02,  2.15325297e+02,  1.26222170e+02],
#  [ 9.69334128e-01,  2.28608379e-02, -1.57759556e-01,  1.87031154e-01,
#   -1.52529145e+01,  2.03712091e+02, -2.25843107e+01,  3.51024440e+01],
#  [ 9.89860373e-01,  1.20154577e-01,  9.91146334e-03,  7.51071461e-02,
#   -3.05601807e+01,  1.11593819e+02,  2.53310669e+02,  1.90809067e+02],
#  [ 9.70017323e-01,  1.29440435e-01,  1.40393444e-01, -1.50337112e-01,
#   -9.72138073e+00,  2.00206594e+02,  1.03548727e+02,  2.06352794e+02],
#  [ 9.91865463e-01, -1.11848297e-01, -1.94114122e-02,  5.75852327e-02,
#    4.50229139e+00,  9.47346828e+01,  3.74433167e+01,  1.19076938e+02],
#  [ 9.91453235e-01,  1.10552251e-01,  8.77526088e-03, -6.87144583e-02,
#   -2.54558381e+01,  2.33482924e+02,  2.32708541e+01,  1.13221804e+01],
#  [ 9.91988714e-01,  6.29252947e-02, -5.15785804e-02,  9.66356532e-02,
#    3.98482934e+00,  6.33257971e+01,  1.55473486e+02,  8.42355268e-01],
#  [ 9.97761860e-01,  1.26245940e-02, -1.44618834e-02,  6.40526676e-02,
#   -7.84544051e+00,  1.60911692e+02,  7.93528874e+01,  1.08411234e+02],]
# Predictions= [[ 1.01093292e+00,  1.05393559e-01, -4.04287018e-02, -1.28185838e-01,
#    5.86721706e+00,  2.15989792e+02,  1.12791000e+02,  7.09335632e+01],
#  [ 1.00388432e+00,  2.01548859e-02, -3.59886363e-02,  5.88001311e-02,
#    4.63507080e+00,  1.58697601e+02,  1.43573410e+02,  8.32798462e+01],
#  [ 9.82589424e-01,  5.45527786e-02,  5.94005873e-03,  1.03658140e-02,
#    2.15919518e+00,  1.31057251e+02,  2.14912323e+02,  1.21484833e+02],
#  [ 1.00983381e+00,  1.20245293e-02, -1.30487561e-01,  2.54702389e-01,
#   -1.15934153e+01,  1.90401199e+02, -2.04187031e+01,  2.43930035e+01],
#  [ 9.76346314e-01,  1.38128430e-01,  4.69697714e-02,  9.63099003e-02,
#   -3.65990906e+01,  1.14391106e+02,  2.50614441e+02,  1.90006454e+02],
#  [ 9.79545534e-01,  1.99155629e-01,  1.39216527e-01, -1.66418880e-01,
#   -1.32472258e+01,  1.99131546e+02,  1.02662560e+02,  2.02217621e+02],
#  [ 1.00360656e+00, -1.36131763e-01, -1.15919877e-02,  8.19273889e-02,
#    7.85339355e+00,  9.24375229e+01,  3.70323563e+01,  1.16406723e+02],
#  [ 1.03524470e+00,  1.04192436e-01,  1.13451093e-01,  4.39053774e-03,
#   -1.76266251e+01,  2.35134567e+02,  2.34031143e+01,  3.30227947e+00],
#  [ 9.91748750e-01,  4.61020544e-02, -2.51235068e-03,  9.21363086e-02,
#   -5.82291603e+00,  5.62804489e+01,  1.55468369e+02, -3.55805492e+00],
#  [ 1.01569545e+00,  2.24148929e-02,  3.95215396e-03,  6.11615777e-02,
#   -5.75170422e+00,  1.59977631e+02,  8.11369324e+01,  1.03731812e+02]]

#30000 samples + 2 Hidden layers
# Poses=  [[ 9.99392838e-01,  4.99405494e-03,  2.50347244e-02,  2.37123783e-02,
#   -6.81427604e+00,  1.74145119e+02,  2.68259734e+01,  2.22199033e+02],
#  [ 9.99746183e-01, -1.57706081e-02, -3.27454441e-03,  1.57523161e-02,
#    1.25998251e+00,  1.03024345e+02,  5.73340757e+01,  3.50955910e+01],
#  [ 9.78202324e-01,  8.21664304e-02, -5.38521237e-02,  1.82944909e-01,
#   -3.27089470e+01,  1.34091551e+02,  8.13949341e+01,  1.38628804e+02],
#  [ 9.98200350e-01, -1.75511970e-02,  4.39831966e-02,  3.67898711e-02,
#   -1.07745755e+01,  1.43421493e+01,  2.38173633e+02,  1.44406388e+01],
#  [ 9.99996583e-01, -1.04318161e-03,  1.91457681e-03,  1.44209656e-03,
#   -3.19090672e-01,  7.72038181e+01,  5.86804428e+01,  1.99209247e+02],
#  [ 9.99852551e-01, -1.29485958e-02,  7.42571800e-03,  8.48930005e-03,
#   -1.38135805e+00,  1.27915644e+02,  2.02595338e+02,  1.80588091e+02],
#  [ 9.93206126e-01, -8.17860308e-02,  1.01679149e-02, -8.21538237e-02,
#    2.28248970e+01,  1.40059950e+02,  1.81469844e+02,  1.58970690e+02],
#  [ 9.99805246e-01, -6.22347843e-03,  1.72194763e-02, -7.36393160e-03,
#    1.05641183e+00,  1.70982347e+02,  3.28128439e+01,  7.56553913e+01],
#  [ 9.96690836e-01, -6.66514866e-02, -4.40013963e-02,  1.51272430e-02,
#    2.05913342e+01,  2.42822259e+02,  1.08383477e+02,  2.84450207e+01],
#  [ 9.89730238e-01,  8.07932851e-02, -8.25243933e-02,  8.42391023e-02,
#   -2.02083244e+01,  1.75541137e+02,  7.09491681e+00,  7.60187156e+01]]
# Predictions= [[ 9.9310917e-01, -1.2974083e-02,  2.8192192e-02,  3.3285141e-02,
#   -1.2689608e+01,  1.7330569e+02,  2.7243050e+01,  2.1096210e+02],
#  [ 1.0266119e+00, -3.1816259e-02,  1.2489736e-02,  4.0838838e-02,
#    3.2820764e+00,  1.0329932e+02,  5.7012711e+01,  7.7074188e+01],
#  [ 9.4729722e-01,  6.5521143e-02, -3.2098293e-02,  2.5605804e-01,
#   -3.7176567e+01,  1.3510768e+02,  7.6485504e+01,  1.8236050e+02],
#  [ 8.7704200e-01, -8.9330673e-02,  1.0792494e-02,  7.2523355e-02,
#   -4.3324924e+00,  1.7729267e+01,  2.4457166e+02,  5.9091961e+01],
#  [ 9.5885569e-01, -3.5775051e-02, -1.8472701e-02,  5.1927984e-02,
#   -3.1593359e+00,  7.6714760e+01,  5.8353020e+01,  1.9707973e+02],
#  [ 9.7371519e-01, -2.9895037e-02,  2.4817884e-02, -2.2781253e-02,
#    1.3953180e+00,  1.2681183e+02,  2.0251749e+02,  1.9145644e+02],
#  [ 1.0142686e+00, -8.5654289e-02,  4.7928095e-04, -5.5608988e-02,
#    1.0263998e+01,  1.3113039e+02,  1.8132625e+02,  1.4897298e+02],
#  [ 1.0426351e+00, -3.2905385e-02,  4.8640430e-02, -2.9444575e-02,
#    4.4814191e+00,  1.7763007e+02,  2.9141148e+01,  1.0134833e+02],
#  [ 1.0686471e+00, -7.1724504e-02, -8.4506184e-02,  2.6652694e-02,
#    1.9519653e+01,  2.4004805e+02,  1.1007349e+02,  4.0169601e+01],
#  [ 1.0057728e+00,  7.2089180e-02, -9.3681067e-02,  1.4043850e-01,
#   -2.1427139e+01,  1.7517162e+02,  3.3258319e+00,  9.6805023e+01]]


#30000 samples + 4  hidden layers
# Poses=  [[ 9.84997998e-01,  1.36522752e-01, -2.82235616e-02,  1.01705032e-01,
#   -4.31993991e+01,  2.50986153e+02,  5.31249723e+01,  9.62133054e+01],
#  [ 9.80238887e-01,  1.76994445e-01,  8.70003908e-02,  1.53500026e-02,
#   -4.84139157e+01,  1.68816164e+02,  2.04888924e+02, -1.61392116e+01],
#  [ 9.81505969e-01, -2.04298126e-02,  1.81613694e-01,  5.69659692e-02,
#   -8.48487264e+00,  1.43277745e+02,  2.64746207e+01,  1.13171724e+02],
#  [ 9.86761141e-01,  1.19413665e-01, -9.25712916e-02,  5.89354127e-02,
#   -1.08264999e+01,  1.86907025e+02,  1.98211904e+02,  1.13898386e+02],
#  [ 9.85464907e-01,  1.20163818e-01,  1.16383786e-01,  2.95700663e-02,
#   -4.26683765e+01,  2.28177860e+02,  1.03699389e+02,  8.65922078e+01],
#  [ 9.90118968e-01,  3.57072132e-02,  1.18215554e-01,  6.64417610e-02,
#   -2.26765036e+01,  1.65263977e+02,  8.08938871e+01,  1.05180906e+02],
#  [ 9.94193699e-01, -9.37919486e-02,  1.17440505e-02, -5.14202049e-02,
#    2.98859531e+01,  2.27219435e+02, -2.25395281e+00,  1.62865981e+02],
#  [ 9.99762477e-01, -1.38346514e-02,  8.19242043e-03, -1.47131139e-02,
#    1.19027440e+00,  7.16075203e+01,  4.05729871e+01,  3.61390232e+01],
#  [ 9.84690249e-01,  1.26679841e-01, -8.14262017e-02, -8.77901239e-02,
#    2.46019744e+01,  6.19192067e+01,  2.68745750e+02,  1.16030066e+02],
#  [ 9.99837400e-01, -4.29162631e-03, -1.02813433e-02,  1.41791793e-02,
#   -8.74691783e-01,  1.98244687e+01,  2.36739240e+02,  2.39338688e+02],]
# Predictions= [[ 9.88906205e-01,  1.37147442e-01, -4.85224910e-02,  1.07905105e-01,
#   -4.32411766e+01,  2.44213150e+02,  4.92011795e+01,  1.05163498e+02],
#  [ 9.93028879e-01,  1.62908137e-01,  3.28872837e-02,  5.93209639e-02,
#   -5.54330597e+01,  1.74037766e+02,  1.98218140e+02, -9.28773594e+00],
#  [ 9.95601296e-01,  1.65722147e-03,  2.19931230e-01,  3.62891406e-02,
#   -5.55789375e+00,  1.35212234e+02,  3.24280930e+01,  1.17793427e+02],
#  [ 9.93492484e-01,  1.24771900e-01, -1.22420460e-01,  6.96215853e-02,
#   -1.19045315e+01,  1.84746124e+02,  1.93967712e+02,  1.26105751e+02],
#  [ 9.93397474e-01,  1.24581620e-01,  1.30846709e-01,  2.77770162e-02,
#   -4.00620804e+01,  2.23603882e+02,  1.02739220e+02,  9.02296448e+01],
#  [ 1.00465369e+00,  5.87773919e-02,  1.37569711e-01,  4.68772203e-02,
#   -2.21213379e+01,  1.56963699e+02,  8.42735825e+01,  1.08200241e+02],
#  [ 1.00100291e+00, -5.36109954e-02,  7.77431726e-02, -7.93359727e-02,
#    3.28958626e+01,  2.22558456e+02, -2.21679497e+00,  1.67053528e+02],
#  [ 1.01061666e+00,  1.61206275e-02, -1.75549090e-03, -2.04293281e-02,
#   -3.44587803e+00,  6.77981110e+01,  4.27656975e+01,  3.52489166e+01],
#  [ 9.87425029e-01,  1.40484333e-01, -1.27764344e-01, -7.16501921e-02,
#    3.05480824e+01,  6.29620781e+01,  2.65627380e+02,  1.24006340e+02],
#  [ 1.00712430e+00,  1.42424610e-02, -1.46056004e-02,  3.71207073e-02,
#    3.65730524e+00,  1.50434313e+01,  2.41741608e+02,  2.36592804e+02]]

#30000 samples 4 Hidden Layers


#50000 samples 8 Hidden Layers
# Poses:  [[ 9.75769014e-01  1.15103259e-01 -1.51459332e-01 -1.08102458e-01
#    1.89053812e+01  1.38757252e+02  9.52337393e+01  1.84960257e+02]
#  [ 9.82721592e-01  7.04482806e-02  1.53364369e-01  7.59913377e-02
#   -4.70955270e+01  1.41410507e+02  1.59749124e+02  1.55541947e+02]
#  [ 9.96480435e-01 -3.22318464e-02 -1.20121987e-02  7.64431636e-02
#   -2.06427787e+00  2.97269070e+01  1.54242696e+02  6.36807700e+01]
#  [ 9.89988887e-01 -1.18717555e-01  7.27400607e-02  2.31738831e-02
#   -7.72988024e+00  7.65782700e+01  2.18493828e+02  3.66976136e+01]
#  [ 9.92223406e-01  1.08443403e-01 -1.17359026e-02  5.99583957e-02
#   -1.07856764e+01  6.77677685e+01  1.96836189e+02  9.44468810e+01]
#  [ 9.84297934e-01 -1.53755572e-01 -5.12626376e-02  6.99209762e-02
#    2.34503575e+00  9.06617300e+01  7.97275177e+01  2.24804859e+02]
#  [ 9.81578217e-01  1.20195882e-02 -1.00377960e-01 -1.62123404e-01
#    4.03692853e+01  2.20080488e+02  2.63656841e+02  9.74908727e+01]
#  [ 9.92280329e-01 -1.07850822e-01  4.41366800e-02 -4.24252655e-02
#    6.80686443e+00  5.56759486e+01  4.23337539e+01  6.17106849e+01]
#  [ 9.94264603e-01 -4.73293199e-02  8.51391375e-02 -4.41493125e-02
#   -4.91755448e+00  4.12379190e+01  1.05234463e+02  4.79839501e+01]
#  [ 9.99453948e-01  9.56695202e-03 -3.70070867e-03  3.14099503e-02
#   -6.15047949e+00  1.62195168e+02  2.23702209e+02  1.72660710e+02]]
# Predictions: [[ 9.7717971e-01  3.0540962e-02 -4.8300192e-02 -7.9596490e-02
#    1.1007254e+01  1.3784633e+02  8.7736504e+01  1.7118324e+02]
#  [ 9.7422498e-01  3.4924474e-02  1.8110557e-01  7.6932229e-02
#   -5.0538544e+01  1.4448807e+02  1.5614792e+02  1.5163193e+02]
#  [ 1.0042024e+00 -8.6653322e-02 -4.6196207e-02  1.1791357e-01
#   -3.7937858e+00  3.0986851e+01  1.4748787e+02  5.8065197e+01]
#  [ 9.9407351e-01 -8.2249202e-02 -4.2312533e-02  5.2119516e-02
#   -9.2269249e+00  7.6789482e+01  2.1620227e+02  3.3292187e+01]
#  [ 9.9862951e-01  5.0486248e-02 -6.8715513e-03  7.5482495e-02
#   -1.1864313e+01  6.8348167e+01  1.8937009e+02  8.7695976e+01]
#  [ 1.0006956e+00 -2.2634818e-01  2.4359539e-02  4.2156987e-02
#    3.4715960e+00  9.2480911e+01  7.0947418e+01  2.1828194e+02]
#  [ 9.8884326e-01 -7.6630861e-02 -7.0473835e-02 -7.3291376e-02
#    2.8177443e+01  2.0807167e+02  2.5934305e+02  8.3191277e+01]
#  [ 9.9116290e-01 -1.1985354e-01  3.9388902e-02 -4.6217356e-02
#    3.9852459e+00  5.3994991e+01  3.9951481e+01  5.0425957e+01]
#  [ 9.9570668e-01 -6.6690564e-02  5.2997515e-02 -3.0253977e-02
#   -6.4526587e+00  3.9554188e+01  1.0198653e+02  4.0316208e+01]
#  [ 9.9600917e-01 -6.6003762e-02  5.2407414e-02  3.5232715e-02
#   -7.0598841e+00  1.6316783e+02  2.1557146e+02  1.6894398e+02]]
